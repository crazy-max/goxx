#!/usr/bin/env bash

set -e

source goxx-env

export GOARCH=$GOARCH
export GOOS=$GOOS
export GOARM=$GOARM
export GOBIN=$GOBIN

if command -v "$AR" >/dev/null 2>/dev/null; then
  export AR=$AR
fi
if command -v "$CC" >/dev/null 2>/dev/null; then
  export CC=$CC
  export CGO_CFLAGS=$CGO_CFLAGS
fi
if command -v "$CXX" >/dev/null 2>/dev/null; then
  export CXX=$CXX
  export CGO_CXXFLAGS=$CGO_CXXFLAGS
fi

if [ -z "$GOBIN" ] && [ -n "$GOPATH" ] && [ -n "$GOARCH" ] && [ -n "$GOOS" ]; then
  export PATH=${GOPATH}/bin/${GOOS}_${GOARCH}:${PATH}
fi

exec go "$@"
